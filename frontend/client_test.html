<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç¢ºèªç”¨ã‚¢ãƒ—ãƒª</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .error { color: red; font-weight: bold; padding: 10px; background: #fee; border: 1px solid red; }
        .item { padding: 10px; border-bottom: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>ğŸ“‹ ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯ (APIé€£æº)</h1>
    
    <input type="text" id="apiUrl" placeholder="Flaky APIã®URLã‚’ã“ã“ã«ãƒšãƒ¼ã‚¹ãƒˆ" style="width: 80%; padding: 8px;">
    <button onclick="fetchTodos()">å–å¾—é–‹å§‹</button>

    <hr>

    <div id="statusArea"></div>
    <div id="listArea"></div>

    <script>
        async function fetchTodos() {
            const url = document.getElementById('apiUrl').value;
            const statusArea = document.getElementById('statusArea');
            const listArea = document.getElementById('listArea');

            if (!url) { alert("URLã‚’å…¥ã‚Œã¦ã­"); return; }

            // ãƒªã‚»ãƒƒãƒˆ
            listArea.innerHTML = "";
            statusArea.innerHTML = '<span class="loader"></span> é€šä¿¡ä¸­... (é…å»¶ã‚’ä½“é¨“ä¸­)';

            try {
                const res = await fetch(url);
                
                // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ†ã‚¹ãƒˆ
                if (!res.ok) {
                    throw new Error(`ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼: ${res.status} ${res.statusText}`);
                }

                const data = await res.json();

                // æˆåŠŸæ™‚ã®è¡¨ç¤º
                statusArea.innerHTML = "âœ… å–å¾—å®Œäº†ï¼";
                
                // ãƒ‡ãƒ¼ã‚¿ãŒé…åˆ—ãªã‚‰ãƒªã‚¹ãƒˆè¡¨ç¤ºã€ãã‚Œä»¥å¤–ãªã‚‰ãã®ã¾ã¾è¡¨ç¤º
                if (Array.isArray(data)) {
                    data.forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'item';
                        div.textContent = item.text || JSON.stringify(item);
                        listArea.appendChild(div);
                    });
                } else {
                    listArea.textContent = JSON.stringify(data, null, 2);
                }

            } catch (err) {
                // ã‚¨ãƒ©ãƒ¼æ™‚ã®è¡¨ç¤ºãƒ†ã‚¹ãƒˆ
                statusArea.innerHTML = `<div class="error">ğŸ’¥ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: ${err.message}</div>`;
            }
        }
    </script>
</body>
</html>